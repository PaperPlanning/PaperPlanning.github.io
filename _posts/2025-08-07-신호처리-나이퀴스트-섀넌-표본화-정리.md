---
layout: post
title: "신호 처리: 나이퀴스트-섀넌 표본화 정리"
date: 2025-08-07 15:00:00 +0900
categories: [신호처리, 이론정리]
---

디지털 신호 처리 시스템에서 연속 시간 신호(analog signal)를 이산 시간 신호(digital signal)로 변환하는 과정은 표본화(sampling)를 통해 이루어진다. 이 과정의 이론적 기반은 나이퀴스트-섀넌 표본화 정리(Nyquist-Shannon Sampling Theorem)에 의해 확립되었다. 본 문서는 해당 정리의 핵심 원리, 수학적 배경, 그리고 실제 시스템 설계에서 흔히 발생하는 오개념 및 그에 따른 문제점을 분석한다.

#### 1. 표본화 정리의 기본 원리

나이퀴스트-섀넌 표본화 정리는 대역 제한(band-limited)된 연속 시간 신호가 손실 없이 디지털화될 수 있는 최소 표본화 주파수를 명시한다. 신호 $x(t)$가 최대 주파수 $f_{max}$를 가지는 대역 제한 신호일 때, 이 신호를 완벽하게 재구성하기 위한 최소 표본화 주파수 $f_s$는 다음과 같다.

$$f_s > 2f_{max}$$

여기서 $2f_{max}$는 나이퀴스트율(Nyquist rate)로 정의된다. 표본화 주파수 $f_s$의 절반인 $f_s/2$는 나이퀴스트 주파수(Nyquist frequency) 또는 폴딩 주파수(folding frequency)라고 불린다.

#### 2. 수학적 분석

연속 시간 신호 $x(t)$의 푸리에 변환(Fourier Transform)을 $X(j\omega)$라고 하자. 표본화는 $x(t)$에 주기적인 임펄스 열(impulse train) $p(t) = \sum_{n=-\infty}^{\infty} \delta(t-nT)$를 곱하는 것으로 모델링할 수 있다. 여기서 $T$는 표본화 주기($T = 1/f_s$)이다.

표본화된 신호 $x_s(t)$는 다음과 같이 표현된다.

$$x_s(t) = x(t) \cdot p(t) = x(t) \sum_{n=-\infty}^{\infty} \delta(t-nT) = \sum_{n=-\infty}^{\infty} x(nT) \delta(t-nT)$$

주기적인 임펄스 열 $p(t)$의 푸리에 변환은 다음과 같다.

$$P(j\omega) = \frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_s)$$

여기서 $\omega_s = 2\pi f_s$는 표본화 각주파수이다.

시간 영역에서의 곱셈은 주파수 영역에서의 컨볼루션(convolution)에 해당하므로, $x_s(t)$의 푸리에 변환 $X_s(j\omega)$는 다음과 같다.

$$X_s(j\omega) = \frac{1}{2\pi} [X(j\omega) * P(j\omega)]$$
$$X_s(j\omega) = \frac{1}{2\pi} \left[ X(j\omega) * \left( \frac{2\pi}{T} \sum_{k=-\infty}^{\infty} \delta(\omega - k\omega_s) \right) \right]$$
$$X_s(j\omega) = \frac{1}{T} \sum_{k=-\infty}^{\infty} X(j(\omega - k\omega_s))$$

이 식은 표본화된 신호의 스펙트럼이 원본 신호의 스펙트럼 $X(j\omega)$가 $\omega_s$ 간격으로 주기적으로 반복되는 형태임을 나타낸다. 원본 신호의 스펙트럼이 중첩되지 않고 완벽하게 재구성되기 위해서는, 각 스펙트럼 복사본이 서로 겹치지 않아야 한다. 즉, $X(j\omega)$의 최대 주파수 $\omega_{max}$에 대해 다음 조건이 만족되어야 한다.

$$\omega_s - \omega_{max} > \omega_{max}$$
$$\omega_s > 2\omega_{max}$$
$$f_s > 2f_{max}$$

이 조건이 만족되면, 표본화된 스펙트럼 $X_s(j\omega)$에서 원본 신호의 스펙트럼을 저역 통과 필터(low-pass filter)를 통해 추출하여 $x(t)$를 완벽하게 재구성할 수 있다.

#### 3. 흔히 발생하는 오개념: "정확히 두 배"의 오류

나이퀴스트-섀넌 표본화 정리의 가장 흔한 오해는 "최대 주파수의 정확히 두 배로 표본화하면 충분하다($f_s = 2f_{max}$)"는 것이다. 이는 이론적으로는 맞지만, 실제 시스템에서는 심각한 문제를 야기할 수 있는 오류이다.

**문제점 분석:**

1.  **이상적인 필터의 부재:** 표본화 정리의 완벽한 재구성은 이상적인 저역 통과 필터(brick-wall filter)를 전제로 한다. 이 필터는 나이퀴스트 주파수($f_s/2$)까지의 모든 주파수 성분은 통과시키고, 그 이상의 주파수 성분은 완벽하게 차단한다. 그러나 실제 아날로그 필터는 유한한 차수(order)와 전이 대역(transition band)을 가지므로, 이상적인 필터처럼 동작할 수 없다.

2.  **앨리어싱(Aliasing) 현상:** 만약 $f_s \le 2f_{max}$인 경우, 원본 신호의 스펙트럼 복사본들이 서로 중첩된다. 이 중첩된 영역의 고주파 성분은 저주파 성분으로 "폴딩(folding)"되어 나타나며, 이를 앨리어싱이라고 한다. 앨리어싱은 원본 신호에 존재하지 않던 가짜 주파수 성분을 생성하여 신호의 왜곡을 초래하며, 일단 발생하면 디지털 영역에서 제거할 수 없다.

    예를 들어, $f_{max} = 10 \text{ kHz}$인 신호를 $f_s = 20 \text{ kHz}$로 표본화한다고 가정하자. 이론적으로는 $10 \text{ kHz}$까지의 신호만 존재해야 하지만, 실제 신호에는 $10 \text{ kHz}$를 초과하는 미세한 고주파 노이즈나 성분이 포함될 수 있다. 이 $10 \text{ kHz}$ 이상의 성분들은 나이퀴스트 주파수($10 \text{ kHz}$)를 넘어 표본화될 때, $f_s - f_{original}$의 주파수로 접혀 들어와 $0 \text{ Hz}$에서 $10 \text{ kHz}$ 사이의 대역에 나타난다. 예를 들어, $12 \text{ kHz}$의 노이즈는 $20 \text{ kHz} - 12 \text{ kHz} = 8 \text{ kHz}$로 나타나 원본 신호의 유효 대역을 오염시킨다.

3.  **안티-앨리어싱 필터(Anti-Aliasing Filter, AAF)의 필요성:** 앨리어싱을 방지하기 위해 표본화 전에 아날로그 저역 통과 필터(AAF)를 사용하여 신호의 주파수 대역을 $f_s/2$ 이하로 제한해야 한다. 이 AAF는 실제 필터이므로 완벽한 차단 특성을 가질 수 없으며, 전이 대역을 고려하여 $f_s$를 $2f_{max}$보다 충분히 높게 설정해야 한다. 즉, $f_s$는 $2f_{max}$보다 훨씬 커야 하며, AAF의 전이 대역이 $f_{max}$와 $f_s/2$ 사이에 위치하도록 설계해야 한다.

    일반적으로 $f_s \ge (2 \text{ to } 5) \times f_{max}$와 같이 나이퀴스트율보다 훨씬 높은 표본화 주파수를 사용한다. 이는 AAF가 충분한 감쇠(attenuation)를 제공할 수 있는 여유 대역(guard band)을 확보하기 위함이다.

#### 4. 실제 시스템 설계에서의 고려사항

1.  **오버샘플링(Oversampling):** 실제 시스템에서는 $f_s \gg 2f_{max}$인 오버샘플링을 흔히 사용한다. 오버샘플링은 다음과 같은 이점을 제공한다.
    *   **AAF 설계 완화:** 표본화 주파수가 높을수록 AAF의 전이 대역이 넓어져, 더 완만한(낮은 차수) 필터를 사용할 수 있게 된다. 이는 필터의 복잡성, 비용, 위상 왜곡 등을 줄이는 데 기여한다.
    *   **신호 대 잡음비(SNR) 개선:** 오버샘플링은 양자화 잡음(quantization noise)을 표본화 주파수 대역 전체에 분산시켜, 관심 대역 내의 잡음 전력을 감소시킨다. 이후 디지털 필터를 통해 관심 대역 외의 잡음을 제거함으로써 유효 SNR을 향상시킬 수 있다.
    *   **디지털 필터링의 이점:** 오버샘플링된 신호는 디지털 영역에서 정교한 디지털 필터링을 적용하여 잡음을 제거하거나 원하는 주파수 대역을 추출하기 용이하다.

2.  **필터 차수 및 차단 주파수:** AAF의 차수와 차단 주파수는 시스템의 요구사항(예: 필요한 SNR, 대역폭)과 ADC(Analog-to-Digital Converter)의 특성을 고려하여 결정된다. 높은 차수의 필터는 더 가파른 차단 특성을 제공하지만, 위상 왜곡이 커지고 구현이 복잡해진다.

3.  **언더샘플링(Undersampling) 또는 밴드패스 샘플링(Bandpass Sampling):** 특정 조건에서는 $f_s < 2f_{max}$인 언더샘플링이 의도적으로 사용될 수 있다. 이는 주로 대역 통과 신호(bandpass signal)의 경우에 적용되며, 신호의 대역폭($B$)에 따라 $f_s > 2B$ 조건을 만족시키면서 신호의 스펙트럼이 나이퀴스트 주파수 내로 접혀 들어오도록 설계한다. 이 경우에도 앨리어싱을 방지하기 위한 밴드패스 필터가 표본화 전에 필수적으로 사용되어야 한다. 이 기법은 RF 신호를 직접 디지털화하여 다운컨버전(downconversion) 효과를 얻는 데 활용된다.

#### 5. 결론

나이퀴스트-섀넌 표본화 정리는 디지털 신호 처리의 근간을 이루는 중요한 이론이다. 그러나 "최대 주파수의 정확히 두 배"라는 표면적인 이해는 실제 시스템 설계에서 앨리어싱이라는 치명적인 오류를 초래할 수 있다. 이상적인 필터의 부재와 실제 신호의 특성을 고려할 때, 표본화 주파수는 나이퀴스트율보다 충분히 높게 설정되어야 하며, 표본화 전에는 반드시 적절한 안티-앨리어싱 필터가 적용되어야 한다. 이러한 실용적인 고려사항을 통해 신호의 무결성을 유지하고 디지털 시스템의 성능을 최적화할 수 있다.
