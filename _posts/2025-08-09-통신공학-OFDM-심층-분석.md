---
layout: post
title: "통신공학: OFDM(직교 주파수 분할 다중화)의 심층 분석 - 스펙트럼 효율성과 PAPR 문제의 실무적 해결"
date: 2025-08-09 09:00:00 +0900
categories: [통신공학, 이론정리, 실무분석, 테크분석]
---

직교 주파수 분할 다중화(Orthogonal Frequency Division Multiplexing, OFDM)는 4G LTE, 5G NR, Wi-Fi, DVB-T 등 현대 고속 무선 통신 시스템의 핵심 변조 기술이다. OFDM은 주파수 선택적 페이딩(Frequency Selective Fading)에 강인하고 높은 스펙트럼 효율성을 제공하지만, 높은 PAPR(Peak-to-Average Power Ratio)이라는 본질적인 문제점을 가진다. 본 문서는 OFDM의 기본 원리, 수학적 배경, 스펙트럼 효율성 증대 메커니즘, 그리고 PAPR 문제의 심층 분석 및 이를 완화하기 위한 실무적 기법들을 다룬다.

#### 1. OFDM의 기본 원리 및 수학적 배경

OFDM은 고속 데이터 스트림을 여러 개의 저속 서브캐리어(Subcarrier)로 분할하여 동시에 전송하는 다중 반송파(Multi-Carrier) 변조 방식이다. 각 서브캐리어는 서로 직교(Orthogonal)하여 서브캐리어 간 간섭(Inter-Carrier Interference, ICI)을 최소화한다.

**1.1. 직교성 (Orthogonality)**

OFDM의 핵심은 서브캐리어 간의 직교성이다. 이는 각 서브캐리어의 주파수가 서브캐리어 간격($\Delta f$)의 정수배로 떨어져 있어, 한 서브캐리어의 피크(Peak)가 다른 서브캐리어의 널(Null)에 위치하도록 설계됨을 의미한다.

$k$번째 서브캐리어의 주파수를 $f_k = f_0 + k \Delta f$라고 할 때, $i$번째 서브캐리어와 $j$번째 서브캐리어 간의 직교성은 다음과 같이 표현된다.

$$\int_0^{T_{sym}} e^{j2\pi f_i t} (e^{j2\pi f_j t})^* dt = \int_0^{T_{sym}} e^{j2\pi (f_i - f_j) t} dt = 0 \quad \text{if } i \ne j$$

여기서 $T_{sym}$은 OFDM 심볼 주기이며, $\Delta f = 1/T_{sym}$이다.

**1.2. OFDM 송수신 과정**

OFDM 송수신기는 주로 고속 푸리에 변환(Fast Fourier Transform, FFT) 및 역고속 푸리에 변환(Inverse Fast Fourier Transform, IFFT)을 사용하여 구현된다.

*   **송신기:**
    1.  **직렬-병렬 변환 (S/P Conversion):** 고속 데이터 스트림을 여러 개의 저속 서브스트림으로 변환한다.
    2.  **매핑 (Mapping):** 각 서브스트림을 QAM(Quadrature Amplitude Modulation) 또는 PSK(Phase Shift Keying)와 같은 디지털 변조 방식으로 심볼(Symbol)로 매핑한다.
    3.  **IFFT:** 매핑된 심볼들을 IFFT 입력으로 사용하여 시간 영역 OFDM 심볼을 생성한다. IFFT는 각 서브캐리어에 해당하는 주파수 성분을 합성하여 직교성을 유지한다.
    4.  **CP 삽입 (Cyclic Prefix Insertion):** OFDM 심볼의 끝 부분을 복사하여 시작 부분에 추가한다. 이는 다중 경로 페이딩(Multipath Fading)으로 인한 심볼 간 간섭(Inter-Symbol Interference, ISI)을 제거하고, 순환 컨볼루션(Cyclic Convolution)을 선형 컨볼루션으로 변환하여 채널 등화(Channel Equalization)를 용이하게 한다.
    5.  **병렬-직렬 변환 (P/S Conversion):** CP가 삽입된 OFDM 심볼을 직렬 스트림으로 변환하여 RF 단으로 보낸다.

*   **수신기:** 송신기의 역과정을 수행한다.
    1.  **직렬-병렬 변환 (S/P Conversion):** 수신된 신호를 병렬 스트림으로 변환한다.
    2.  **CP 제거 (CP Removal):** CP를 제거한다.
    3.  **FFT:** 시간 영역 OFDM 심볼을 주파수 영역 심볼로 변환한다. 직교성 덕분에 각 서브캐리어의 데이터는 다른 서브캐리어의 영향을 받지 않고 분리된다.
    4.  **채널 등화 (Channel Equalization):** 채널의 주파수 응답 왜곡을 보상한다.
    5.  **디매핑 (Demapping):** 수신된 심볼을 비트 스트림으로 변환한다.
    6.  **병렬-직렬 변환 (P/S Conversion):** 비트 스트림을 직렬 데이터로 변환한다.

#### 2. OFDM의 스펙트럼 효율성 및 주파수 선택적 페이딩 강인성

**2.1. 높은 스펙트럼 효율성**

OFDM은 서브캐리어들이 서로 중첩되어 있지만 직교성을 유지하므로, 가드 밴드(Guard Band) 없이도 서브캐리어 간 간섭 없이 데이터를 전송할 수 있다. 이는 전통적인 FDM(Frequency Division Multiplexing) 방식이 서브캐리어 간 간섭을 피하기 위해 넓은 가드 밴드를 필요로 하는 것과 대조적이다. 따라서 OFDM은 주어진 대역폭 내에서 더 많은 데이터를 전송할 수 있어 스펙트럼 효율성이 높다.

**2.2. 주파수 선택적 페이딩 강인성**

무선 채널은 다중 경로 전파로 인해 주파수 선택적 페이딩을 유발한다. 이는 채널의 주파수 응답이 주파수에 따라 불균일하게 변하는 현상이다.

*   **OFDM의 강인성:** OFDM은 전체 대역폭을 여러 개의 좁은 서브채널로 분할한다. 각 서브채널의 대역폭은 채널의 코히어런스 대역폭(Coherence Bandwidth)보다 작게 설계되므로, 각 서브채널은 거의 평탄한 페이딩(Flat Fading)을 겪는다. 따라서 주파수 선택적 페이딩이 발생하더라도 일부 서브캐리어만 영향을 받고, 나머지 서브캐리어는 정상적으로 데이터를 전송할 수 있다.
*   **채널 등화 용이성:** 각 서브캐리어는 평탄 페이딩을 겪으므로, 주파수 영역에서 간단한 1-탭 등화기(1-Tap Equalizer)로 채널 왜곡을 보상할 수 있다. 이는 단일 반송파 시스템에서 복잡한 시간 영역 등화기를 필요로 하는 것과 대조적이다.
*   **파일럿 심볼 (Pilot Symbol):** 각 OFDM 심볼에 주기적으로 파일럿 심볼을 삽입하여 채널 상태 정보를 추정하고, 이를 기반으로 채널 등화를 수행한다.

#### 3. PAPR (Peak-to-Average Power Ratio) 문제의 심층 분석

OFDM의 가장 큰 단점 중 하나는 높은 PAPR이다. 이는 여러 개의 서브캐리어 신호가 시간 영역에서 동위상(In-Phase)으로 중첩될 때 순간적으로 평균 전력보다 훨씬 높은 피크 전력이 발생하는 현상이다.

**3.1. PAPR의 정의 및 발생 원리**

OFDM 심볼 $x(t)$는 $N$개의 서브캐리어 신호의 합으로 표현된다.

$$x(t) = \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} X_k e^{j2\pi f_k t}, \quad 0 \le t < T_{sym}$$

여기서 $X_k$는 $k$번째 서브캐리어의 복소 심볼이다.

PAPR은 피크 전력($|x(t)|^2_{max}$)과 평균 전력($E[|x(t)|^2]$)의 비율로 정의된다.

$$PAPR = \frac{\max_{0 \le t < T_{sym}} |x(t)|^2}{E[|x(t)|^2]}$$

PAPR은 일반적으로 dB 단위로 표현된다. $N$개의 독립적인 서브캐리어가 동위상으로 중첩될 경우, 이론적인 최대 PAPR은 $N$에 비례하여 증가한다. 예를 들어, $N=64$인 경우 최대 PAPR은 $10 \log_{10}(64) = 18 \text{ dB}$에 달할 수 있다.

**3.2. 높은 PAPR의 문제점**

높은 PAPR은 다음과 같은 심각한 문제점을 야기한다.

*   **전력 증폭기(PA)의 비선형성:** 높은 PAPR 신호는 PA의 선형 동작 영역을 벗어나 비선형 영역으로 쉽게 진입하게 만든다. 이는 신호 왜곡(Distortion)을 유발하고, 인접 채널 누설 전력(Adjacent Channel Leakage Ratio, ACLR)을 증가시켜 인접 채널 간섭을 유발한다. PA는 높은 피크 전력을 처리할 수 있도록 설계되어야 하므로, 백오프(Back-off)를 크게 해야 하며, 이는 PA의 효율을 저하시킨다.
*   **ADC/DAC의 동적 범위 요구사항:** 높은 PAPR 신호를 처리하기 위해서는 ADC(Analog-to-Digital Converter)와 DAC(Digital-to-Analog Converter)가 넓은 동적 범위(Dynamic Range)를 가져야 한다. 이는 ADC/DAC의 복잡성과 비용을 증가시킨다.
*   **클리핑(Clipping)으로 인한 성능 저하:** PA의 선형 영역을 넘어서는 피크 신호는 클리핑되어 잘려나간다. 클리핑은 신호에 비선형 왜곡을 추가하고, 대역 외 방출(Out-of-Band Emission)을 증가시키며, 비트 오류율(Bit Error Rate, BER)을 악화시킨다.

#### 4. PAPR 완화 기법 (PAPR Reduction Techniques)

높은 PAPR 문제를 해결하기 위해 다양한 PAPR 완화 기법들이 연구되고 실제 시스템에 적용된다.

**4.1. 클리핑 (Clipping)**

가장 간단한 방법으로, 피크 전력이 특정 임계값을 초과하면 해당 신호를 잘라내는 것이다.

*   **장점:** 구현이 매우 간단하다.
*   **단점:** 신호에 비선형 왜곡을 유발하고, 대역 외 방출을 증가시킨다. 클리핑 레벨이 너무 낮으면 BER 성능이 저하된다.

**4.2. 선택적 맵핑 (Selected Mapping, SLM)**

동일한 정보를 여러 개의 다른 OFDM 심볼로 매핑하고, 이들 중 가장 낮은 PAPR을 가지는 심볼을 선택하여 전송하는 방법이다.

*   **장점:** 왜곡 없이 PAPR을 효과적으로 줄일 수 있다.
*   **단점:** 각 심볼에 대한 사이드 정보(Side Information)를 수신기에 전송해야 하므로 대역폭 효율이 약간 감소한다. 여러 개의 IFFT 연산이 필요하여 계산 복잡도가 증가한다.

**4.3. 부분 전송 시퀀스 (Partial Transmit Sequence, PTS)**

OFDM 심볼을 여러 개의 서브블록으로 분할하고, 각 서브블록에 위상 회전 계수(Phase Rotation Factor)를 곱한 후 합산하여 PAPR이 가장 낮은 조합을 선택하는 방법이다.

*   **장점:** SLM과 유사하게 왜곡 없이 PAPR을 효과적으로 줄일 수 있다.
*   **단점:** SLM과 마찬가지로 사이드 정보 전송 오버헤드와 계산 복잡도가 존재한다.

**4.4. 능동 컨스텔레이션 확장 (Active Constellation Extension, ACE)**

OFDM 심볼의 피크를 줄이기 위해 컨스텔레이션 점(Constellation Point)을 확장하는 방법이다. 이는 신호의 평균 전력을 증가시키지 않으면서 피크 전력을 줄일 수 있다.

*   **장점:** 왜곡 없이 PAPR을 줄일 수 있다.
*   **단점:** 컨스텔레이션 점이 확장되므로 잡음에 대한 내성(Noise Immunity)이 약간 감소할 수 있다.

**4.5. 톤 예약 (Tone Reservation, TR)**

일부 서브캐리어(톤)를 데이터 전송에 사용하지 않고, PAPR을 줄이기 위한 보조 신호를 전송하는 데 예약하는 방법이다.

*   **장점:** 왜곡 없이 PAPR을 줄일 수 있다.
*   **단점:** 예약된 톤만큼 데이터 전송률이 감소하여 스펙트럼 효율이 약간 저하된다.

#### 5. 실무적 통찰: PAPR 완화 기법의 선택과 시스템 트레이드오프 (FAQ 포함)

PAPR 완화 기법의 선택은 시스템의 요구사항(성능, 복잡도, 전력 소모, 대역폭 효율)에 따라 달라진다.

**Q1: "PAPR 완화 기법은 항상 필요한가?"
**A1:** 모든 OFDM 시스템에 PAPR 완화 기법이 필수적인 것은 아니다. 시스템의 PA 특성, ADC/DAC의 동적 범위, 그리고 요구되는 BER 성능에 따라 PAPR 완화 기법의 필요성이 결정된다. 예를 들어, 낮은 전력으로 동작하는 시스템이나, PA의 선형성이 매우 좋은 경우에는 PAPR 완화 기법 없이도 충분할 수 있다. 그러나 5G와 같이 높은 변조 차수와 넓은 대역폭을 사용하는 시스템에서는 PAPR 완화가 필수적이다.

**Q2: "PAPR 완화 기법을 적용하면 항상 이득만 있는가?"
**A2: 아니다.** 대부분의 PAPR 완화 기법은 PAPR을 줄이는 대신 다음과 같은 트레이드오프를 가진다.
*   **계산 복잡도 증가:** SLM, PTS 등은 여러 번의 IFFT 연산이나 최적화 과정을 필요로 하여 송신기 측의 계산 복잡도를 증가시킨다.
*   **대역폭 효율 감소:** SLM, PTS는 사이드 정보 전송을 위한 오버헤드가 발생하고, TR은 일부 서브캐리어를 예약하므로 데이터 전송률이 감소한다.
*   **신호 왜곡:** 클리핑과 같이 비선형적인 기법은 신호에 왜곡을 유발하여 BER 성능을 저하시킨다.
*   **전력 소모 증가:** PAPR 완화 알고리즘의 연산으로 인해 송신기 측의 전력 소모가 증가할 수 있다.

**Q3: "5G NR에서는 PAPR 문제를 어떻게 다루는가?"
**A3:** 5G NR은 OFDM을 기반으로 하지만, PAPR 문제를 완화하기 위해 다양한 접근 방식을 사용한다.
*   **CP-OFDM (Cyclic Prefix OFDM):** 기존 LTE와 동일하게 CP-OFDM을 사용하며, 이는 PAPR 문제를 내재한다.
*   **DFT-s-OFDM (Discrete Fourier Transform-spread-OFDM):** 상향링크(Uplink)에서 사용되는 변조 방식 중 하나로, DFT 확산(DFT Spreading)을 통해 PAPR을 낮춘다. 이는 단일 반송파(Single Carrier) 신호와 유사한 특성을 가지므로, PA의 효율을 높일 수 있다.
*   **유연한 서브캐리어 간격:** 5G NR은 다양한 서브캐리어 간격(Subcarrier Spacing)을 지원하여, 특정 시나리오에서 PAPR을 최적화할 수 있는 유연성을 제공한다.
*   **첨단 PA 기술:** DPD(Digital Pre-Distortion)와 같은 PA 선형화 기술을 사용하여 PA의 효율을 유지하면서도 높은 PAPR 신호를 처리할 수 있도록 한다.

#### 6. 결론

OFDM은 주파수 선택적 페이딩에 강인하고 높은 스펙트럼 효율성을 제공하여 현대 무선 통신 시스템의 핵심 기술로 자리매김했다. 그러나 높은 PAPR이라는 본질적인 문제점은 PA의 비선형성, ADC/DAC의 동적 범위 요구사항, 그리고 클리핑으로 인한 성능 저하를 야기한다. 클리핑, SLM, PTS, ACE, TR 등 다양한 PAPR 완화 기법들이 개발되었으며, 각 기법은 PAPR 감소 효과와 함께 계산 복잡도, 대역폭 효율, 신호 왜곡 등의 트레이드오프를 가진다. 시스템 설계자는 이러한 트레이드오프를 신중하게 고려하여 애플리케이션의 요구사항에 가장 적합한 PAPR 완화 기법을 선택해야 한다. 5G NR과 같은 최신 통신 시스템에서는 PAPR 문제를 해결하기 위한 다양한 기술적 접근 방식이 통합적으로 적용되고 있으며, 이는 OFDM 기반 시스템의 성능을 극대화하는 데 필수적이다.
